<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<title>Programación Web</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
          <img data-src="img/logo_white.png" width="25%" height="25%" style="margin: none; background: none; border: none; box-shadow: none;">
          <h2>Programación Web</h2>
          <p>
            <small>Rodrigo Albano</small>
          </p>
          <img data-src="img/logo_linux.png" width="15%" height="15%" style="margin: none; background: none; border: none; box-shadow: none;">
          <img data-src="img/logo_apache.png" width="25%" height="25%" style="margin: none; background: none; border: none; box-shadow: none;">
          <img data-src="img/logo_mysql.png" width="25%" height="25%" style="margin: none; background: none; border: none; box-shadow: none;">
          <img data-src="img/logo_php.png" width="25%" height="25%" style="margin: none; background: none; border: none; box-shadow: none;">
        </section>

				<section>
          <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
          <h2>Indice</h2>
          <ol>
            <li><a href="#/2">Instalar ambiente</a></li>
            <!-- Descargar e Instalar los Software a Utilizar (XAMPP, Sublime Text o Visual Studio Code)
            Imprimir el primer Hola Mundo -->
            <li><a href="#/3">Aprendiendo PHP</a></li>
            <!-- Sintaxis
            Variables
            Tipo de Datos
            Comentarios
            Expresiones y Operadores
            Funciones
            Ejercicios -->
            <li><a href="#/4">Diseño de Aplicaciones Web</a></li>
            <!-- Diseño de formularios
            Verbos (PUT - GET - POST - HEAD - DELETE)
            REST
            Codigos HTTP
            Formato JSON
            Interaccion con API -->
            <li><a href="#/5">Funciones útiles</a></li>
            <!-- Cookies
            File-Uploads
            Correo -->
            <li><a href="#/6">Trabajando con Base de Datos</a></li>
            <!-- El manejo de Base de Datos MySQL
            Manipulación de una Base de Datos con PHP
            Consideraciones de Seguridad mysqli -->
            <li><a href="#/7">Programación Orientada a Objetos</a></li>
            <!-- Declaración y definición de Clases
            Creación de Objetos
            Métodos y atributos de los objetos
            Herencia -->
            <!-- Framework Laravel -->
            <li><a href="#/8">Framework Laravel</a></li>
          </ol>
        </section>

        <!--
        TEMA 1: Instalar ambiente
        -->
        <section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Instalar ambiente</h2>
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <ul>
              <li>Editor de Texto Sublime: https://www.sublimetext.com/</li>
              <li>Instalar Servicio Apache y PHP con XAMPP: https://www.apachefriends.org/es/index.html</li>
            </ul>
            <img data-src="img/xampp.png" width="60%" height="60%" style="margin: none; background: none; border: none; box-shadow: none;">
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Directorio Root de Apache</h2>
            <ul>
              <li>En Windows el directorio root de apache es: <b>"C:/xampp/htdocs"</b></li>
              <li>En Linux el directorio root de apache es: <b>"/opt/lampp/htdocs"</b></li>
            </ul>
            <p>Creamos una carpeta llamada "progweb" bajo la ruta htdocs</p>
          </section>

          <section data-markdown>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            
          <script type="text/template">
            ## phpinfo y "Hola Mundo"

            Crear archivo "phpinfo.php" dentro de "progweb"

            ```
            <?php 
              phpinfo();
            ?>
            ```
            Crear archivo "index.php" dentro de "progweb"
            ```
            <?php 
              echo "Hola Mundo";
            ?>
            ```
          </script>  
          </section>
        </section>
        <!--
        TEMA 1: Instalar ambiente
        -->

        <!--
        TEMA 2: Aprendiendo PHP
				-->
        <section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Aprendiendo PHP</h2>
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 50px;">
            <h2>¿Qué es PHP? (Hypertext Preprocessor)</h2>
            <ul>
              <li>Lenguaje de programación del lado del servidor.</li>
              <li>De código abierto, cualquiera puede modificar la estructura y la forma de cómo hacer las cosas con PHP.</li>
              <li>Lenguaje dinámico.</li>
              <li>Todos los archivos deben terminar con ".php"</li>
              <li>Todo el código PHP debe estar dentro de la etiqueta de inicio <?php y finalización ?>.</li>
            </ul>
          </section>

        </section>
        <!--
        TEMA 2: Aprendiendo PHP Fin
        -->

        <!--
        TEMA 3: Diseño de Aplicaciones Web
				-->
        <section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Diseño de Aplicaciones Web</h2>
          </section>
        </section>
        <!--
        TEMA 3: Diseño de Aplicaciones Web - Fin
        -->

        <!--
        TEMA 4: Funciones útiles - Inicio
				-->
        <section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Funciones útiles</h2>
            https://github.com/albanorodrigo/anima-testmail
          </section>
					<!--
					TEMA 4: Funciones útiles - Fin
					-->
        </section>

				<!--
        TEMA 5: Trabajando con Base de Datos - inicio
        -->
				<section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Trabajando con Base de Datos</h2>
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>PHP MySQLi Introducción</h3>

            <ul>
              <li>PHP MySQL evolucionó en PHP MySQLi</li>
              <li>Las funciones MySQLi le permite acceder a servidores de bases de datos MySQL</li>
              <li>La extensión mysqli se introdujo con la versión de PHP 5.0.0. El controlador nativo de MySQL se incluyó en la versión de PHP 5.3.0</li>
              <li>Documentación de las funciones: <a href="https://www.w3bai.com/es/php/php_ref_mysqli.html" target="_blank">Ir documentación</a></li>
            </ul>

          </section>


          <section>
            <pre><code class="hljs" data-trim contenteditable>

                // Conectando, seleccionando la base de datos
                $link = mysqli_connect('localhost', 'user', 'pass', 'database')
                // Check connection
                if (mysqli_connect_errno())
                {
                echo "Failed to connect to MySQL: " . mysqli_connect_error();
                }

                // Realizar una consulta MySQL
                $query = 'SELECT * FROM Usuario';
                $result = mysqli_query($link,$query) or die('Consulta fallida: ' . mysqli_error());

                // Imprimir los resultados en HTML
                echo "<table>\n";
                while ($line = mysqli_fetch_array($result)) {
                    echo "\t<tr>\n";
                    foreach ($line as $col_value) {
                        echo "\t\t<td>$col_value</td>\n";
                    }
                    echo "\t</tr>\n";
                }
                echo "</table>\n";

                // Liberar resultados
                mysqli_free_result($result);

                // Cerrar la conexión
                mysqli_close($link);

            </code></pre>
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>PHP PDO - Data Objects</h3>

            <ul>
              <li>Una extensión para acceder a bases de datos.</li>
              <li>Permite acceder a diferentes sistemas de base de datos con un controlador específico (MySQL, SQLite, Oracle, etc.)</li>
              <li>El sistema PDO se fundamenta en 3 clases: PDO, PDOStatement y PDOException. PDO - mantener la conexión a la base de datos. PDOStatement, la que maneja las sentencias SQL y devuelve los resultados. La clase PDOException se utiliza para manejar los errores.</li>
              <li>Documentación: <a href="https://www.php.net/manual/es/book.pdo.php" target="_blank">Ir documentación</a></li>
            </ul>

          </section>


          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Implementación de una Clase utilzando PDO</h3>
            <pre><code class="hljs" data-trim contenteditable>

                class DB{
                    private $host;
                    private $db;
                    private $user;
                    private $password;
                    private $charset;

                    public function __construct(){
                        $this->host     = 'localhost';
                        $this->db       = 'mibase';
                        $this->user     = 'user';
                        $this->password = 'password';
                        $this->charset  = 'utf8mb4';
                    }

                    function connect(){
                    
                        try{

                            
                            $connection = "mysql:host=".$this->host.";dbname=" . $this->db . ";charset=" . $this->charset;
                            $options = [
                                PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
                                PDO::ATTR_EMULATE_PREPARES   => false,
                            ];
                            //$pdo = new PDO($connection, $this->user, $this->password, $options);
                            $pdo = new PDO($connection,$this->user,$this->password);
                        
                            return $pdo;


                        }catch(PDOException $e){
                            print_r('Error connection: ' . $e->getMessage());
                        }   
                    }
                }


            </code></pre>
          </section>

        <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Utilizando Clase Extendida de DB</h3>
            <pre><code class="hljs" data-trim contenteditable>

              // Primero incluimos el código que contiene la Clase DB
              include_once 'db.php';

              class Pelicula extends DB{
                  
                  function obtenerPeliculas(){
                      $query = $this->connect()->query('SELECT * FROM pelicula');
                      return $query;
                  }

                  function obtenerPelicula($id){
                      $query = $this->connect()->prepare('SELECT * FROM pelicula WHERE idPelicula = :id');
                      $query->execute(['id' => $id]);
                      return $query;
                  }

                  function nuevaPelicula($pelicula){
                      $query = $this->connect()->prepare('INSERT INTO pelicula (nombre, img) VALUES (:nombre, :img)');
                      $query->execute(['nombre' => $pelicula['nombre'], 'img' => $pelicula['img']]);
                      return $query;
                  }

              }
            </code></pre>
          </section>

        </section>
				<!--
				TEMA 5: Trabajando con Base de Datos - Fin
				-->
        <!--
        TEMA 6: Programación Orientada a Objetos - Inicio
        -->
        <section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Programación Orientada a Objetos</h2>
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Creación de Clase</h3>
            <pre><code class="hljs" data-trim contenteditable>

              class Persona
              {
                private $fechaNacimiento = '1991-09-03';
                private $nombre = 'Rodrigo';
                private $apellido = 'Albano';

                //Constructor Vacio
                public function __construct()
                {
                  $this->nombre = '';
                  $this->apellido = '';
                  $this->fechaNacimiento = '';
                }
                // $Persona = new Persona();

                //Constructor con Parámetros
                public function __construct($nombre, $apellido, $fechaNacimiento)
                {
                  $this->nombre = $nombre;
                  $this->apellido = $apellido;
                  $this->fechaNacimiento = $fechaNacimiento;
                }
                // $Persona = new Persona("Pepe", "Lopez", "1980-01-01");

                //Destructor
                public function __destruct()
                {
                  //Hacer algo cuando se destruye el objeto
                }

                public function nombreCompleto(){
                  return $this->nombre." ".$this->apellido;
                  
                }

                public function edad(){
                  //Calcular edad
                  list($ano,$mes,$dia) = explode("-",$this->fechaNacimiento);
                  $ano_diferencia  = date("Y") - $ano;
                  $mes_diferencia = date("m") - $mes;
                  $dia_diferencia   = date("d") - $dia;
                  if ($dia_diferencia < 0 || $mes_diferencia < 0){
                      $ano_diferencia--;
                  }
                  return $ano_diferencia;
                }
              }

              ?>
            </code></pre>
          </section>
        </section>
        <!--
        TEMA 6: Programacion Orientada a Objetos - Fin
        -->
        
        <!--
        TEMA 7: Laravel Framework - Inicio
        -->
        <section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h2>Laravel Framework</h2>
          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>¿Qué es Laravel?</h3>

            <ul>
              <li>Laravel es un framework de PHP para ayudarnos en un tipo de desarrollo sobre aplicaciones escritas en este lenguaje de programación</li>
              <li>Framework del tipo MVC (Modelo-Vista-Controlador) da como resultado que podamos “despreocuparnos” (por así decirlo) en ciertas aspecto del desarrollo</li>
              <li>Interfaz de comando "Artisan"</li>
              <li>Documentación: <a href="https://laravel.com/docs/" target="_blank">Ir documentación</a></li>
            </ul>

          </section>

          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Configurar Entorno - 1</h3>
            <pre><code class="hljs" data-trim contenteditable>
              // Para Laravel 8 es necesario la utilización de Composer como su manejador de dependencias.
              // Descargar e instalar desde: https://getcomposer.org/
              // Tutorial para instalar Composer: https://styde.net/instalacion-de-composer/

              // Instalar Laravel con Composer
              $ composer global require laravel/installer

              // Setear nuestro proyecto
              $ composer create-project --prefer-dist laravel/laravel anima-api

              // Nos paramos en el proyecto y probamos..
              $ cd anima-api
              $ php artisan serv

              // Ingresamos a la Web "http://127.0.0.1:8000" y chequeamos el acceso. Si vemos la Web de "Laravel" estamos ok!

              // Creamos el Modelo "Pelicula"
              $ php artisan make:model Pelicula

              // Creamos el Controlador "PeliculaController" utilizamos "--resource para crear los "CRUD" basicos
              $ php artisan make:controller PeliculaController --resource

              // Creamos API controller para estandarizar los retornos de nuestra API
              $ php artisan make:controller ApiController

            </code></pre>
          </section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Configurar Entorno - 2</h3>
            <pre><code class="hljs" data-trim contenteditable>
              // CONFIGURAMOS V-HOST

              // Agregamos las siguientes lineas al archivo “c:\xampp\apache\conf\extra\httpd-vhosts.conf”
              <VirtualHost *:80>
                  DocumentRoot "C:/xampp/htdocs/anima_api/public"
                  ServerName anima-api.localhost
                  ErrorLog "logs/anima-api_error.localhost.log"
                  CustomLog "logs/anima-api_access.localhost.log" common
              </VirtualHost>
              // Reiniciamos el servicio APACHE
              // Probamos ingresando a la URL “http://anima-api.localhost/”
            </code></pre>
          </section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Modificamos Código - BD</h3>
            <pre><code class="hljs" data-trim contenteditable>
              // Modificamos el archivo “.env” para configurar la conexión a la Base de Datos.
              DB_CONNECTION=mysql
              DB_HOST=127.0.0.1
              DB_PORT=3306
              DB_DATABASE=peliculas
              DB_USERNAME=root
              DB_PASSWORD=
              //Agregamos las siguientes lineas al archivo “config/database.php” para configurar la conexión a la Base de Datos
              'peliculas' => [
                          'driver' => 'mysql',
                          'url' => env('DATABASE_URL'),
                          'host' => env('DB_HOST', '127.0.0.1'),
                          'port' => env('DB_PORT', '3306'),
                          'database' => env('DB_DATABASE', 'forge'),
                          'username' => env('DB_USERNAME', 'forge'),
                          'password' => env('DB_PASSWORD', ''),
                          'unix_socket' => env('DB_SOCKET', ''),
                          'charset' => 'utf8mb4',
                          'collation' => 'utf8mb4_unicode_ci',
                          'prefix' => '',
                          'prefix_indexes' => true,
                          'strict' => true,
                          'engine' => null,
                          'options' => extension_loaded('pdo_mysql') ? array_filter([
                              PDO::MYSQL_ATTR_SSL_CA => env('MYSQL_ATTR_SSL_CA'),
                          ]) : [],
                      ],
            </code></pre>
          </section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Modificamos Código - Pelicula (Modelo)</h3>
            <pre><code class="hljs" data-trim contenteditable>
              namespace App\Models;

              use Illuminate\Database\Eloquent\Model;

              class Pelicula extends Model
              {
              
                  protected $connection='peliculas';
                  protected $table='pelicula';
                  protected $primaryKey = "idPelicula";
                  public $timestamps=false;
              }
            </code></pre>
          </section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Modificamos Código - ApiController (Controlador)</h3>
            <pre><code class="hljs" data-trim contenteditable>
              // Modificamos el código de ApiController para estandarizar los retornos de nuestra API
              namespace App\Http\Controllers;

              use Illuminate\Http\Request;

              class ApiController extends Controller
              {
                  public function sendResponse($result, $message){
                      $response = [
                          "success" => true,
                          "data" => $result,
                          "message" => $message
                      ];
                      return response()->json($response, 200);
                  }

                  public function sendError($error, $errorMessages = [], $code = 404){
                      $response = [
                          "success" => false,
                          "error" => $error,
                          "errorMessages" => $errorMessages
                      ];
                      return response()->json($response, $code);
                  }
              }
            </code></pre>
          </section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Modificamos Código - PeliculaController (Controlador)</h3>
            <pre><code class="hljs" data-trim contenteditable>
              // Editamos las funciones “index”, “store” y “show”
              public function index()
                  {
                      $Peliculas = Pelicula::where('activo','=',1)
                                  ->select('idPelicula','nombre','img')
                                  ->get();

                      return $this->sendResponse($Peliculas,"Peliculas obtenidas correctamente");
                      // return $this->sendError("Error Conocido", "Error controlado", 200);
                  }
              public function store(Request $request)
                  {
                      try {
                          $Pelicula = new Pelicula();
                          $Pelicula->nombre = $request->input('img');
                          $Pelicula->img = $request->input('nombre');
                          $Pelicula->save();
                          return $this->sendResponse($Pelicula,"Pelicula ingresada correctamente");
                      } catch (Exception $e) {
                          return $this->sendError("Error Conocido", "Error al crear la Pelicula", 200);
                      }
                      
                  }
              public function show($id)
              {
                  $Pelicula = Pelicula::where('idPelicula',$id)
                              ->select('idPelicula','nombre','img')
                              ->get();
              return $this->sendResponse($Pelicula,"Pelicula obtenida correctamente");
              }

            </code></pre>
          </section>
          <section>
            <img data-src="img/logo_white.png" style="background: none; border: none; box-shadow: none; position: fixed; top: 0; right: 0; height: 100px;">
            <h3>Modificamos Código - Rutas a la API</h3>
            <pre><code class="hljs" data-trim contenteditable>
              // Agregamos la siguiente ruta a la API para exponer los endpoint del CRUD
              
              Route::apiResource('/pelicula', App\Http\Controllers\PeliculaController::class);
              
              // Probamos las rutas desde la consola con 
              $ php artisan route:list
            </code></pre>
          </section>
        </section>
        <!--
        TEMA 7: Laravel Framework- Fin
        -->

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
